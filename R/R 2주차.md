## 1.막대그래프와 원그래프

# 1.0. 자료생성
## '상' 2명 / '중' 6명 / '하' 3명

# 자료를 직접 입력
# 문자형 자료(character)이므로 ""를 사용. 
# x, X 대소문자 구별 잘 하기. 
X <- c("상","상","중","중","중","중","중","중","하","하","하")

# rep() 함수를 이용해서 자료를 생성.
# rep() 이라는 함수는 자료를 반복(replicate)해서 만들어주는 함수
# rep(x,...) / rep(x, each= , times= )
# rep(자료 내용 벡터, times=자료의 개수 벡터) 
?rep # 함수 앞에 ?를 붙이면, 사용법을 알려줍니다. 
X1 <- rep(c('상', '중', '하'), times=c(2,6,3)) # 상을 2번, 중은 6번, 하를 3번 반복 / times 생략가능
X
X1


# 1.1. 막대그래프(bar chart)
table(X)				  # table() : 빈도수/ 도수분포표를 생성해주는 함수. 
# table() : 인자로 벡터를 가짐.

barplot(table(X))	# barplot(): 막대그래프를 생성해주는 함수.
# barplot(): 인자로 도수분포표(table)을 가짐. 
?barplot

## 창 분할
# par() 그래픽 파라미터를 지정. 한 창에 몇 개의 그림을 그릴 것인지 설정하는 함수. 
# Par(mfrow=c(행 개수, 열 개수))
par(mfrow=c(2,2)) # 한 창에서 2 x 2 개의 그림을 그릴 수 있음. 

## 항목 이름 설정하기
# names.arg 라는 옵션을 이용해 지정. 
barplot(table(X), names.arg=c('A','B','C'))

## 색깔 바꾸기 
# col 이라는 옵션 추가 및 이용해 지정.  
# 더 다양한 색깔은 color in R 이라고 구글링하셔서 확인하고 사용하시면 됩니다. 
barplot(table(X), names.arg=c('A','B','C'), col=c('green','yellow', 'red'))

## 범례 설정하기 
# legend라는 옵션을 추가 및 이용해 지정.  
barplot(table(X), names.arg=c('A','B','C'), col=c('red','yellow','green')
        ,legend= c('상','중','하'))

## 제목 설정하기  
# main 이라는 옵션을 추가 및 이용해 설정. 
barplot(table(X), names.arg=c('A','B','C'), col=c('red','yellow','green')
        ,legend= c('상','중','하'), main="성적별 빈도수")

## 제목과 축이름 붙이기 
# barplot() 함수 안에서 main, sub 등의 옵션을 추가해서 이름을 붙일 수도 있고, 
# title() 함수 이용해서 현재 그림에 제목과 축이름을 붙일 수도 있어요.
title(main='성적별 빈도수')	# 제목
title(sub='1반')			      # 부제목 
title(xlab='성적')		     	# x축 이름
title(ylab='빈도수')		    # y축 이름



# 1.2. 원그래프(pie chart)
## 새로운 활성화창
windows() # 새로운 창 생성

pie(table(X))		# pie() : 원 그래프(pie chart)를 생성해주는 함수.
# Pie() : 역시 인자로 table을 가짐. 
par(mfrow=c(1,1))
## 순서대로 정렬하기 -------------------------------------------------------------
# decreasing 이라는 옵션을 지정. 
pie(sort(table(X), decreasing=TRUE))	     # 내림차순

table <- sort(table(X), decreasing = TRUE) # sort() 라는 함수로 table(X) 순서 조절. 

table

pie(table)

# 제목과 축이름 붙이기 
title(main='성적별 빈도수')		# 제목
title(sub='1반')			      	# 부제목 

## 퍼센트 값으로 라벨을 지정해주기 
# 먼저 퍼센트를 구해봅시다. 
table/sum(table)*100

# 퍼센트를 구한 후, round() 함수로 소수 둘째짜리까지 반올림. 
pct <- round(table/sum(table)*100, 2) # 그리고 이것을 pct라는 객체에 저장. 
label <- paste(names(table), "\n", pct, "%")

pie(table, labels=label)

## 기준선 변경(init.angle) 
pie(table, init.angle=90)	#(원래는 0도 기준) 90도를 기준선으로 시작해서 그림

## 원 크기 조절(radius) 
pie(table, radius=0.9) 	  # 지름의 크기를 조절하는 옵션. 

## 방향 바꾸기(clockwise)
pie(table, clockwise=T)   # 시계방향 반시계 방향을 조절하는 옵션. 


## 2. 그래프를 이용한 수치형 자료의 정리


# 실습 데이터 : 키 자료
x <- c(154, 156, 160, 161, 162, 167, 167, 170, 170,
       171, 171, 172, 172, 175, 177, 178, 183, 200)
x 

# summary() 함수: 함수 안에 수치형 자료를 넣으면, 수치통계 혹은 요약통계량을 제시
# min, 1st Q, median, mean, 3rd Q, max 
summary(x)

# 히스토그램(histomram) 
# 값의 범위마다 빈도를 표시한 그래프
# hist()라는 함수를 사용.
hist(x)
?hist
# 옵션 조절을 통해, 너비나 제목 등을 바꿀 수 있음   
hist(x, breaks=10, xlab="height", main="Histomgram of height") 


# 줄기잎그림(stem) 
# 히스토그램을 옆으로 돌려 놓은 것과 동일
# stem()이라는 함수를 사용. 
stem(x)

# 상자 그림(boxplot) 
# 다섯 숫자 요약을 시각적으로 표현. + 이상점 유무를 파악하는데 유용.
# boxplot()이라는 함수를 사용. 
boxplot(x)
